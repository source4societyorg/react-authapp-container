'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.resetApplicationAlertReducerFunction=exports.setApplicationAlertReducerFunction=exports.fetchedDoubleCookieReducerFunction=exports.loadedAuthFromLocalStorageReducerFunction=exports.logoutPostedReducerFunction=exports.loginPostedReducerFunction=exports.initialState=undefined;exports.default=appReducer;var _immutable=require('immutable');var _scepterUtilityLib=require('@source4society/scepter-utility-lib');var _reactRouterRedux=require('react-router-redux');var _constants=require('./constants');var initialState=exports.initialState=(0,_immutable.fromJS)({loading:false,error:false,jwt:'',userId:'',username:'',isAuthenticated:false,userRoles:[],expires:0,loadedAuthFromLocalStorage:false,message:{},doubleCookie:'',jwtClaims:{}});var loginPostedReducerFunction=exports.loginPostedReducerFunction=function loginPostedReducerFunction(state,action){return state.set('jwt',action.jwt).set('userId',action.userId).set('username',action.username).set('expires',action.expires).set('userRoles',(0,_immutable.List)(action.userRoles)).set('isAuthenticated',true).set('jwtClaims',(0,_immutable.fromJS)(action.jwtClaims))};var logoutPostedReducerFunction=exports.logoutPostedReducerFunction=function logoutPostedReducerFunction(state){return state.set('jwt',initialState.get('jwt')).set('userId',initialState.get('userId')).set('username',initialState.get('username')).set('userRoles',initialState.get('userRoles')).set('expires',initialState.get('expires')).set('isAuthenticated',false).set('jwtClaims',initialState.get('jwtClaims'))};var loadedAuthFromLocalStorageReducerFunction=exports.loadedAuthFromLocalStorageReducerFunction=function loadedAuthFromLocalStorageReducerFunction(state,action){if(!(0,_scepterUtilityLib.isEmpty)(action.jwt)){return state.set('jwt',action.jwt).set('userId',action.userId).set('username',action.username).set('userRoles',(0,_immutable.List)(action.userRoles)).set('expires',action.expires).set('isAuthenticated',true).set('jwtClaims',(0,_immutable.fromJS)(action.jwtClaims)).set('loadedAuthFromLocalStorage',true)}return state.set('loadedAuthFromLocalStorage',true)};var fetchedDoubleCookieReducerFunction=exports.fetchedDoubleCookieReducerFunction=function fetchedDoubleCookieReducerFunction(state,action){return state.set('doubleCookie',action.doubleCookie)};var setApplicationAlertReducerFunction=exports.setApplicationAlertReducerFunction=function setApplicationAlertReducerFunction(state,action){return state.set('message',(0,_immutable.fromJS)(action.message))};var resetApplicationAlertReducerFunction=exports.resetApplicationAlertReducerFunction=function resetApplicationAlertReducerFunction(state){return state.set('message',initialState.get('message'))};function appReducer(injectedState,action,injectedLoginPostedReducer,injectedLogoutPostedReducer,injectedLoadedAuthFromLocalStorageReducer,injectedFetchedDoubleCookieReducer,injectedSetApplicationAlertReducer,injectedResetApplicationAlertReducer){var state=(0,_scepterUtilityLib.valueOrDefault)(injectedState,initialState);var loginPostedReducer=(0,_scepterUtilityLib.valueOrDefault)(injectedLoginPostedReducer,loginPostedReducerFunction);var logoutPostedReducer=(0,_scepterUtilityLib.valueOrDefault)(injectedLogoutPostedReducer,logoutPostedReducerFunction);var loadedAuthFromLocalStorageReducer=(0,_scepterUtilityLib.valueOrDefault)(injectedLoadedAuthFromLocalStorageReducer,loadedAuthFromLocalStorageReducerFunction);var fetchedDoubleCookieReducer=(0,_scepterUtilityLib.valueOrDefault)(injectedFetchedDoubleCookieReducer,fetchedDoubleCookieReducerFunction);var setApplicationAlertReducer=(0,_scepterUtilityLib.valueOrDefault)(injectedSetApplicationAlertReducer,setApplicationAlertReducerFunction);var resetApplicationAlertReducer=(0,_scepterUtilityLib.valueOrDefault)(injectedResetApplicationAlertReducer,resetApplicationAlertReducerFunction);switch(action.type){case _constants.LOGIN_POSTED:return loginPostedReducer(state,action);case _constants.LOGOUT_POSTED:return logoutPostedReducer(state,action);case _constants.LOADED_AUTH_FROM_LOCAL_STORAGE:return loadedAuthFromLocalStorageReducer(state,action);case _constants.FETCHED_DOUBLE_COOKIE:return fetchedDoubleCookieReducer(state,action);case _constants.SET_APPLICATION_ALERT:return setApplicationAlertReducer(state,action);case _reactRouterRedux.LOCATION_CHANGE:case _constants.RESET_APPLICATION_ALERT:return resetApplicationAlertReducer(state,action);default:return state;}}
